<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>ZyTerra â€” Detalhe da Cultura</title>

<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #eef4fb;
    display: flex;
  }

  /* SIDEBAR */
  .sidebar {
    width: 240px;
    background: #163b63;
    color: white;
    height: 100vh;
    position: fixed;
    left: 0;
    top: 0;
    padding: 22px 14px;
  }

  .sidebar h2 {
    text-align: center;
    margin-bottom: 30px;
  }

  .menu-item {
    padding: 12px;
    border-radius: 8px;
    display: block;
    margin-bottom: 10px;
    text-decoration: none;
    color: white;
  }

  .menu-item:hover {
    background: #0f2a46;
  }

  /* MAIN */
  .main {
    margin-left: 240px;
    padding: 30px;
    width: calc(100% - 240px);
  }

  h1 {
    color: #163b63;
    margin-top: 0;
  }

  .card {
    background: white;
    padding: 22px;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.06);
  }

  .result {
    background: #f1f7ff;
    padding: 12px;
    border-radius: 8px;
    margin-top: 10px;
    border: 1px solid #d1e4ff;
    display: none;
  }
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>ğŸŒ¾ ZyTerra</h2>

  <a class="menu-item" href="/">ğŸ  Painel</a>
  <a class="menu-item" href="/culturas">ğŸŒ± Culturas</a>
  <a class="menu-item" href="/insumos">ğŸ§ª Insumos AgrÃ­colas</a>
  <a class="menu-item" href="/pecuaria">ğŸ„ PecuÃ¡ria</a>
  <a class="menu-item" href="/analises">ğŸ“Š AnÃ¡lises de Solo</a>
  <a class="menu-item" href="/plantas-daninhas">ğŸŒ¿ Plantas Daninhas</a>
</div>

<!-- MAIN CONTENT -->
<div class="main">

  <h1 id="titulo">Cultura</h1>
  <p><a href="/culturas" style="color:#163b63;font-weight:600;">â† Voltar</a></p>

  <!-- CARD â€“ Valores Ideais -->
  <div class="card">
    <h2>ğŸ“Š Valores Ideais do Solo (EMBRAPA)</h2>
    <ul id="valores"></ul>
  </div>

  <!-- CARD â€“ InformaÃ§Ãµes -->
  <div class="card">
    <h2>ğŸ“˜ InformaÃ§Ãµes AgronÃ´micas</h2>

    <p id="info"></p>

    <h3>ğŸ¦  DoenÃ§as Comuns</h3>
    <ul id="doencas"></ul>

    <h3>ğŸ› Pragas</h3>
    <ul id="pragas"></ul>

    <h3>ğŸŒ¿ Manejo</h3>
    <p id="manejo"></p>

    <h3>ğŸ§ª ExigÃªncias Nutricionais</h3>
    <ul id="exigencias"></ul>
  </div>

  <!-- CARD â€“ IA -->
  <div class="card">
    <h2>ğŸ§  IA da Cultura â€” DiagnÃ³stico</h2>

    <label>Sintomas observados:</label>
    <textarea id="sym" style="width:100%;height:90px;"></textarea>
    <button onclick="diagSym()" style="margin-top:10px;">Diagnosticar</button>

    <div id="symRes" class="result"></div>

    <hr>

    <h3>ğŸ”¬ Solo</h3>
    <label>pH</label>
    <input id="ph" type="number" step="0.1">

    <label>P (mg/dmÂ³)</label>
    <input id="p" type="number">

    <label>K (mg/dmÂ³)</label>
    <input id="k" type="number">

    <button onclick="diagSoil()" style="margin-top:10px;">Comparar solo</button>
    <div id="soilRes" class="result"></div>

    <hr>

    <button onclick="diagCombined()" style="font-weight:600;">Gerar diagnÃ³stico combinado</button>
    <div id="combined" class="result"></div>
  </div>

</div>

<!-- SCRIPT: BANCO DE DADOS + LÃ“GICA -->
<script>
/* =====================================================
   BANCO DE DADOS DAS CULTURAS (culturasDB)
===================================================== */
const culturasDB = {

  "soja": {
    nome:"Soja",
    valores:{ph:"5.8â€“6.2", P:"20â€“40 mg/dmÂ³", K:"80â€“120 mg/dmÂ³"},
    info:"Cultura altamente responsiva a NitrogÃªnio e PotÃ¡ssio, sensÃ­vel a pH baixo.",
    doencas:["Ferrugem asiÃ¡tica","Mancha-alvo","OÃ­dio"],
    pragas:["Percevejo","Lagarta-do-cartucho","Helicoverpa"],
    manejo:"RotaÃ§Ã£o de culturas, controle de plantas daninhas, uso de fungicidas estratÃ©gicos.",
    exigencias:["Alta demanda de N","Alta demanda de K","Micronutrientes essenciais: Mn, Zn, B"]
  },

  "milho": {
    nome:"Milho",
    valores:{ph:"5.8â€“6.5", P:"15â€“30", K:"120â€“200"},
    info:"Planta de alto potencial produtivo, responde muito a NitrogÃªnio.",
    doencas:["Helmintosporiose","Ferrugem","Cercosporiose"],
    pragas:["Lagarta-do-cartucho","Broca-do-colmo"],
    manejo:"N em cobertura, MIP, controle prÃ©-pÃ³s emergente.",
    exigencias:["Alta demanda de N","Moderada demanda de S","Micronutriente chave: Zn"]
  },

  "feijao": {
    nome:"FeijÃ£o",
    valores:{ph:"5.5â€“6.5", P:"15â€“30", K:"100â€“140"},
    info:"Crescimento rÃ¡pido e sensÃ­vel a estresse hÃ­drico.",
    doencas:["Antracnose","Mancha angular"],
    pragas:["Mosca-branca","Percevejo"],
    manejo:"Tratamento de sementes, manejo de irrigaÃ§Ã£o.",
    exigencias:["Alta demanda de K","SensÃ­vel a falta de micronutrientes"]
  },

  "cafe": {
    nome:"CafÃ©",
    valores:{ph:"5.5â€“6.5", P:"10â€“25", K:"100â€“180"},
    info:"Cultura perene, exige adubaÃ§Ã£o anual e manejo nutricional contÃ­nuo.",
    doencas:["Ferrugem","Cercosporiose"],
    pragas:["Bicho-mineiro","Broca-do-cafÃ©"],
    manejo:"Poda, adubaÃ§Ã£o parcelada, controle integrado.",
    exigencias:["Alta demanda de Ca, Mg e K"]
  },

  "abacate": {
    nome:"Abacate",
    valores:{ph:"5.5â€“6.5", P:"10â€“25", K:"120â€“200"},
    info:"Demanda alta de drenagem e Ca no solo.",
    doencas:["Antracnose","PodridÃ£o radicular"],
    pragas:["Mosca-das-frutas","Ãcaros"],
    manejo:"Poda, correÃ§Ã£o de solo, irrigaÃ§Ã£o moderada.",
    exigencias:["Alta demanda de Ca","K elevado na frutificaÃ§Ã£o"]
  }
};

/* =====================================================
   CARREGAR A CULTURA
===================================================== */
function load(){
  const slug = new URLSearchParams(window.location.search).get("nome");
  const c = culturasDB[slug];

  if(!c){
    document.getElementById("titulo").innerText = "Cultura nÃ£o encontrada";
    return;
  }

  document.getElementById("titulo").innerText = c.nome;

  document.getElementById("valores").innerHTML =
    Object.entries(c.valores).map(([k,v]) => `<li><b>${k.toUpperCase()}:</b> ${v}</li>`).join("");

  document.getElementById("info").innerText = c.info;
  document.getElementById("manejo").innerText = c.manejo;

  document.getElementById("doencas").innerHTML =
    c.doencas.map(d=>`<li>${d}</li>`).join("");

  document.getElementById("pragas").innerHTML =
    c.pragas.map(p=>`<li>${p}</li>`).join("");

  document.getElementById("exigencias").innerHTML =
    c.exigencias.map(e=>`<li>${e}</li>`).join("");
}

load();

/* =====================================================
   IA â€“ DiagnÃ³stico inteligente
===================================================== */
function diagSym(){
  const txt = document.getElementById("sym").value.toLowerCase();
  const box = document.getElementById("symRes");

  if(!txt.trim()){
    box.innerHTML = "Descreva os sintomas.";
    box.style.display = "block";
    return;
  }

  let r = "";

  if(txt.includes("amarel")) r += "â¡ Pode indicar falta de NitrogÃªnio.<br>";
  if(txt.includes("mancha")) r += "â¡ Pode indicar doenÃ§a fÃºngica.<br>";
  if(txt.includes("murch")) r += "â¡ Pode ser raiz danificada ou falta de Ã¡gua.<br>";

  if(r === "") r = "Nenhuma causa clara encontrada.";

  box.innerHTML = r;
  box.style.display = "block";
}

function diagSoil(){
  const ph = parseFloat(document.getElementById("ph").value);
  const p = parseFloat(document.getElementById("p").value);
  const k = parseFloat(document.getElementById("k").value);

  let r = "";

  if(ph < 5.5) r += "pH baixo â€” aplicar calcÃ¡rio.<br>";
  if(p < 10) r += "FÃ³sforo muito baixo â€” precisa de adubaÃ§Ã£o fosfatada.<br>";
  if(k < 80) r += "PotÃ¡ssio baixo â€” aplicar KCl ou fonte equivalente.<br>";

  if(r === "") r = "Valores dentro do aceitÃ¡vel.";

  const box = document.getElementById("soilRes");
  box.innerHTML = r;
  box.style.display = "block";
}

function diagCombined(){
  const box = document.getElementById("combined");
  box.innerHTML = `
    <b>RecomendaÃ§Ã£o geral:</b><br>
    â€¢ Ajustar pH se necessÃ¡rio.<br>
    â€¢ Corrigir P e K conforme anÃ¡lise.<br>
    â€¢ Monitorar sintomas nas folhas.<br>
    â€¢ Seguir manejo recomendado da cultura.<br>
  `;
  box.style.display = "block";
}
</script>

</body>
</html>
